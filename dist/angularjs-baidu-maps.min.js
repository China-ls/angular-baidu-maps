/*! angular-baidu-maps 2017-01-13 */
"use strict";function bindMapEvents(a,b,c,d,e){e=e||"map-",angular.forEach(b.split(" "),function(b){c.addEventListener(b,function(c){d.triggerHandler(e+b,c),a.$$phase||a.$apply()})})}var loadBaiduPromise,loadBaiduMaps=function(a,b,c){if(loadBaiduPromise)return loadBaiduPromise;var d=a.defer(),e=function(){d.resolve(!!window.BMap&&window.BMap)},f="loadBaiduMaps_"+(new Date).getTime(),g={ak:b,v:c};if(window.BMap)e();else{angular.extend(g,{v:c||"2.0",callback:f}),window[f]=function(){e(),setTimeout(function(){try{delete window[f]}catch(a){}},20)};var h=document.getElementsByTagName("HEAD").item(0),i=document.createElement("script");i.type="text/javascript",i.src="http://api.map.baidu.com/api?v="+g.v+"&ak="+g.ak+"&callback="+g.callback,h.appendChild(i)}return loadBaiduPromise=d.promise},lsBaiduMapModule=angular.module("ls.bmap",[]);lsBaiduMapModule.value("uiBaiduMapConfig",{}).directive("uiBaiduMap",["uiBaiduMapConfig","$parse","$q",function(a,b,c){var d="click dblclick rightclick rightdblclick maptypechange mousemove mouseover mouseout movestart moving moveend zoomstart zoomend addoverlay addcontrol removecontrol removeoverlay clearoverlays dragstart dragging dragend addtilelayer removetilelayer load resize hotspotclick hotspotover hotspotout tilesloaded touchstart touchmove touchend longpress",e=a||{};return{restrict:"A",link:function(a,f,g){var h=angular.extend({},e,a.$eval(g.mapOptions));if(a.opts=h,!h.apiKey)throw new Error("no apiKey was set in options!");var i=function(){var c="undefined"==typeof h.enableMapClick||h.enableMapClick,e=new window.BMap.Map(f[0],{enableMapClick:c});if(e.addMarker=function(a,b){e.addOverlay(a),b&&a.addEventListener("click",b)},h.center){var i=new BMap.Point(h.center.longitude,h.center.latitude);e.centerAndZoom(i,h.zoom||11)}h.enableScrollWheelZoom&&e.enableScrollWheelZoom();var j=b(g.uiBaiduMap);j.assign(a,e);var k=a.$eval(g.mapEvent);angular.forEach(k,function(c,d){var e=b(c);f.bind(d,function(b){var c=Array.prototype.slice.call(arguments);c=c.splice(1),e(a,{$event:b,$params:c}),a.$$phase||a.$apply()})}),bindMapEvents(a,d,e,f),f.triggerHandler("map-loaded")},j=function(){h.onMapLoadFild()};loadBaiduMaps(c,h.apiKey).then(i,j)}}}]).value("uiBaiduMapInfoWindowConfig",{}).directive("uiBaiduMapInfoWindow",["uiBaiduMapInfoWindowConfig","$parse","$compile",function(a,b,c){var d=a||{};return{link:function(a,e,f){var g=function(){var g=angular.extend({},d,a.$eval(f.uiOptions)),h=b(f.uiBaiduMapInfoWindow),i=h(a);if(!i){i=new window.BMap.InfoWindow(e[0],g),h.assign(a,i);var j=a.$eval(f.infoWindowEvent);angular.forEach(j,function(c,d){var e=b(c);i.addEventListener(d,function(b){var c=Array.prototype.slice.call(arguments);c=c.splice(1),e(a,{$event:b,$params:c}),a.$$phase||a.$apply()})})}e.replaceWith("<div></div>"),i.open=function(b){c(e.contents())(a),b.openInfoWindow(i)}};loadBaiduMaps().then(g)}}}]);